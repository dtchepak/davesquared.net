---
layout: "post"
title: "Modifying the SQL generated by NHibernate"
blogger_id: "tag:blogger.com,1999:blog-7624394686148711990.post-3858633285652586875"
categories: ["nhibernate"]
date: "2008-08-26T16:56:00.0+10:00"
updated: "2008-08-26T17:12:54.911+10:00"
---

<p>Is it possible to modify the SQL generated by NHibernate? Yes:</p>

<pre>public class BadInterceptor : EmptyInterceptor, IInterceptor {
 SqlString IInterceptor.<b>OnPrepareStatement(SqlString sql)</b> {
  return doHorribleThingsToSqlString(sql);            
 }
 private SqlString doHorribleThingsToSqlString(SqlString sql) { ... }
}

protected static readonly ISessionFactory SessionFactory = initialiseSessionFactory();
private static ISessionFactory initialiseSessionFactory() {
 var config = new Configuration();
 config.AddAssembly(Assembly.GetExecutingAssembly());
 <b>config.SetInterceptor(new BadInterceptor())</b>;
 return config.BuildSessionFactory();
}
</pre>

<p>Now don't! :) Seriously, it's evil.</p>

<p>If anyone knows a nice way to get NHibernate to add some custom SQL as part of it's SQL generation process, rather than this brute-force approach, then please let me know. I was initially playing around with this code to add some calls to SQL Server's <code><a href="http://msdn.microsoft.com/en-us/library/ms173784.aspx">binary_checksum()</a></code> function when loading and saving entities, and I'd be interested if this is possible to do in a reasonably robust way.</p>
