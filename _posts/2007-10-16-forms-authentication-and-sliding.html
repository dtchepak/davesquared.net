---
layout: "post"
title: "Forms Authentication and sliding expiration"
blogger_id: "tag:blogger.com,1999:blog-7624394686148711990.post-7458164453009407995"
categories: [".net"]
date: "2007-10-16T15:20:00.0+10:00"
updated: "2008-05-01T09:04:07.732+10:00"
---

<p>Sliding expiration sounds pretty simple right?&nbsp;&nbsp;From <a href="http://msdn2.microsoft.com/en-us/library/1d3t3c61.aspx">MSDN</a>&nbsp;(emphasis mine):</p> <blockquote> <p>"Sliding expiration resets the active authentication time for a cookie to expire <strong><em>upon each request</em></strong> during a single session."</p></blockquote> <p>Great! So if I want to synchronise the authentication timeout with the session timeout, that should be a simple matter of setting the forms authentication expiration and session timeout to the same value, and enabling sliding expiration.</p> <p>This would be fantastic if MSDN wasn't a <strong><em>deceptive, dishonest fiend*</em></strong>! From a different place on the same <a href="http://msdn2.microsoft.com/en-us/library/1d3t3c61.aspx">MSDN</a> page (last bit of emphasis mine):</p> <blockquote> <p>"If the <b>SlidingExpiration</b> attribute is <b>true</b>, the <b>timeout</b> attribute is a sliding value, expiring at the specified number of minutes after the time that the last request was received. To prevent compromised performance, and to avoid multiple browser warnings for users who have cookie warnings turned on, <strong><em>the cookie is updated when more than half of the specified time has elapsed</em></strong>. This might cause a loss of precision."</p></blockquote> <p>Raj Kaimal has a <a href="http://weblogs.asp.net/rajbk/archive/2004/10/11/241080.aspx">good example</a> of the effect of this, and it is explained in a bit more detail <a title="here" href="http://support.microsoft.com/kb/910443">here</a>. This is a <a href="http://www.velocityreviews.com/forums/t95194-p-go-to-login-page-when-session-expires.html">real pain if you want the user to login again after their session expires</a>, and so you would like the session and authentication ticket to expire after the same period of inactivity. </p> <p>The solution in this case is to manually refresh the forms authentication cookie on each request (or set the expiry to double the session timeout time), and ensure the authentication cookie is cleared and the user is forced to the login page on Session_Start.</p> <p style="font-size: xx-small">* I still love you MSDN,&nbsp;despite your propensity for providing misleading information and your clumsy interface :)&nbsp;</p>
