---
layout: "post"
title: "NUnit 2.4+ constraint-based assertion syntax"
blogger_id: "tag:blogger.com,1999:blog-7624394686148711990.post-888009809102293117"
categories: [".net"]
date: "2007-06-13T15:32:00.0+10:00"
updated: "2008-05-01T09:04:07.754+10:00"
---

<p>NUnit has moved to a constraint-based assertion syntax in the last release, which&nbsp;allows&nbsp;constraints to be specified in&nbsp;semi-natural language. </p> <p>For example, the classic style of asserting equality was:</p> <p><font face="Courier New">&nbsp; Assert.AreEqual(expectedValue, actualValue);</font></p> <p>Using constraint-based syntax, this becomes:</p> <p><font face="Courier New">&nbsp; Assert.That(actualValue, Is.EqualTo(expectedValue));</font></p> <p>This is a bit more natural to read and write, and makes it quite explicit which value is being checked in the assertion and which is the expected value. This syntax is also very flexible, and allows you to create some really interesting constraints. NUnit provides a number of syntax helpers to make writing these very easy. These syntax handlers are basically factories for a number of&nbsp;classes that implement <font face="Courier New">IConstraint</font>. In the example above, <font face="Courier New">Is</font> is the syntax helper, and&nbsp;<font face="Courier New">Is.EqualTo(object)</font> is a factory method that creates an <font face="Courier New">EqualConstraint</font> object.</p> <p>I always forget these syntax handler shortcuts, and end up referring to a&nbsp;<a href="http://nunit.com/blogs/?p=44">post from Charlie about NUnit 2.4 RC2</a>, or using <a href="http://www.aisto.com/roeder/dotnet/">Reflector</a>. So here is a summary for my future reference (so I can bug myself instead of the NUnit blog :-)).</p> <ul> <li><strong>Has</strong>: Check object&nbsp;properties (property value and length).  <li><strong>Is</strong>: the main helper. Can check for equality, null, true/false, type, comparisons and more.  <li><strong>List</strong>: Can check if a list contains an specific object.  <li><strong>Text</strong>: Various string-based constraints.</li></ul> <p><font face="Courier New">SyntaxHelper</font> classes&nbsp;also have some other useful properties, such as <strong>Not</strong>, <strong>All</strong>, <strong>Some</strong>, that can be used for negation and collections. You can also use the <strong>!</strong>, <strong>&amp;</strong>, and <strong>|</strong> operators to negate, AND, and OR constraints together.</p> <p>Finally, there are some constraint modifiers like <strong>AsCollection</strong>, <strong>IgnoreCase</strong> and <strong>Within(tolerance)</strong> attached to some constraint types that are quite cool.</p>
